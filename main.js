(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{z:()=>c,G:()=>a});var n={baseUrl:"https://nomoreparties.co/v1/wff-cohort-19",headers:{authorization:"ff55c8a5-9e93-41a4-b092-8c36fdb087a0","Content-Type":"application/json"}};function o(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}var r=function(e){return fetch("".concat(n.baseUrl,"/cards/").concat(e._id),{method:"DELETE",headers:n.headers}).then(o)};function c(e,t,n,o,r){var c=document.querySelector("#card-template").content.querySelector(".places__item").cloneNode(!0),a=c.querySelector(".card__image"),i=c.querySelector(".card__title"),u=c.querySelector(".card__delete-button"),s=c.querySelector(".card__like-button"),l=e._id;return i.textContent=e.name,a.src=e.link,a.alt=e.name,t===e.owner._id?u.addEventListener("click",(function(){return n(c,l)})):u.remove(),a.addEventListener("click",(function(){return o(e)})),s.addEventListener("click",(function(){s.classList.contains("card__like-button")&&s.classList.toggle("card__like-button_is-active")})),c}function a(e,t){r(t).then((function(){e.target.closest(".places__item").remove()})).catch((function(e){console.log(e)}))}function i(e){e.classList.add("popup_is-animated"),e.classList.add("popup_is-opened"),document.addEventListener("keydown",s),document.addEventListener("mousedown",l)}function u(e){e.classList.add("popup_is-animated"),e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",s),document.removeEventListener("mousedown",l)}function s(e){"Escape"===e.key&&u(document.querySelector(".popup_is-opened"))}function l(e){e.target.classList.contains("popup_is-opened")&&u(e.target)}var p=function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""},d=function(e,t){var n=e.querySelector(t.submitButtonSelector),o=Array.from(e.querySelectorAll(t.inputSelector));o.forEach((function(n){p(e,n,t)})),f(o,n,t)},f=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))},_=document.querySelector(".places__list"),m=document.querySelector(".profile__edit-button"),y=document.querySelector(".profile__add-button"),v=document.querySelector(".popup_type_edit"),S=document.querySelector(".popup_type_avatar"),h=document.querySelector(".popup_type_new-card"),b=document.querySelectorAll(".popup__close"),q=v.querySelector(".popup__form"),k=q.querySelector(".popup__input_type_name"),g=q.querySelector(".popup__input_type_description"),L=h.querySelector(".popup__form"),E=L.querySelector(".popup__input_type_card-name"),C=L.querySelector(".popup__input_type_url"),x=document.querySelector(".profile__title"),j=document.querySelector(".profile__description"),w=document.querySelector(".popup_type_image"),A=w.querySelector(".popup__image"),O=w.querySelector(".popup__caption"),D=document.querySelector(".profile__image"),P=S.querySelector(".popup__form"),T=P.querySelector(".popup__input_type_url"),B={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function M(e,t){t.querySelector(".popup__button").textContent=e?"Сохранение...":"Сохранить"}function U(e){A.src=e.link,A.alt=e.name,O.textContent=e.name,i(w)}[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].forEach((function(e){_.prepend(c(e,a,U))})),_.addEventListener("click",U),m.addEventListener("click",(function(e){e.preventDefault(),i(v),k.value=x.textContent,g.value=j.textContent,d(v,B)})),q.addEventListener("submit",(function(e){var t,r,c;e.preventDefault(),M(!0,q),(t={name:k.value,about:g.value},r=t.name,c=t.about,fetch("".concat(n.baseUrl,"/users/me"),{method:"PATCH",headers:n.headers,body:JSON.stringify({name:r,about:c})}).then(o)).then((function(e){x.textContent=e.name,j.textContent=e.about,u(v)})).catch((function(e){console.log(e)})).finally((function(){M(!1,q)}))})),D.addEventListener("click",(function(e){e.preventDefault(),i(S),d(S,B)})),P.addEventListener("submit",(function(e){var t;e.preventDefault(),M(!0,P),(t=T.value,fetch("".concat(n.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:t})}).then(o)).then((function(e){D.style.backgroundImage="url(".concat(e.avatar,")"),u(S)})).catch((function(e){console.log(e)})).finally((function(){M(!1,P)}))})),y.addEventListener("click",(function(e){e.preventDefault(),i(h),d(h,B)})),L.addEventListener("submit",(function(e){e.preventDefault();var t={name:E.value,link:C.value};M(!0,L),function(e){return fetch("".concat(n.baseUrl,"/cards"),{method:"POST",headers:n.headers,body:JSON.stringify({name:e.name,link:e.link})}).then(o)}(t).then((function(e){_.prepend(c(e,e.owner._id,U,a)),u(h)})).catch((function(e){console.log(e)})).finally((function(){M(!1,L)}))})),b.forEach((function(e){e.addEventListener("click",(function(){u(e.closest(".popup"))}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);f(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?p(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(e,r,t),f(n,o,t)}))}))}(t,e)}))}(B)})();